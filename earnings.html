<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Earnings | PlayForge</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="container">
        <h1>Developer Monetization</h1>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 30px;">
            <div class="game-card" style="padding: 30px;">
                <p>Net Earnings (Developer 70%)</p>
                <h2 id="dev-money" style="font-size: 3rem; color: var(--success);">$0.00</h2>
            </div>
            <div class="game-card" style="padding: 30px;">
                <p>Total Ad Views</p>
                <h2 id="total-views" style="font-size: 3rem; color: var(--primary);">0</h2>
            </div>
        </div>
        <div class="ad-slot">Your payout threshold: $100.00</div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script>
        auth.onAuthStateChanged(user => {
            if(user) {
                db.collection('games').where('developerId', '==', user.uid).get().then(snap => {
                    let views = 0;
                    snap.forEach(d => views += (d.data().views || 0));
                    
                    const cpm = 2.0; // $2.00 per 1000 views
                    const totalRev = (views / 1000) * cpm;
                    const devShare = totalRev * 0.70; // 70% share

                    document.getElementById('dev-money').innerText = `$${devShare.toFixed(2)}`;
                    document.getElementById('total-views').innerText = views.toLocaleString();
                });
            }
        });
    </script>
</body>
</html>
